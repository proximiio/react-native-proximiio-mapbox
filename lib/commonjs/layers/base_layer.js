"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.default=exports.Serializable=void 0;var _defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));var _classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));var _createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass"));var _lodash=require("lodash");var _helpers=require("../helpers");function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;})),keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){(0,_defineProperty2.default)(target,key,source[key]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}return target;}var Serializable=function(){function Serializable(){(0,_classCallCheck2.default)(this,Serializable);}(0,_createClass2.default)(Serializable,[{key:"json",get:function get(){return(0,_helpers.kebabize)(this);}}]);return Serializable;}();exports.Serializable=Serializable;var BaseLayer=function(){function BaseLayer(data){(0,_classCallCheck2.default)(this,BaseLayer);(0,_defineProperty2.default)(this,"id",void 0);(0,_defineProperty2.default)(this,"source",void 0);(0,_defineProperty2.default)(this,"sourceLayer",void 0);(0,_defineProperty2.default)(this,"type",void 0);(0,_defineProperty2.default)(this,"minZoomLevel",void 0);(0,_defineProperty2.default)(this,"maxZoomLevel",void 0);(0,_defineProperty2.default)(this,"filter",void 0);(0,_defineProperty2.default)(this,"paint",void 0);(0,_defineProperty2.default)(this,"layout",void 0);(0,_defineProperty2.default)(this,"metadata",void 0);this.id=data.id;this.type=data.type;this.source=data.source;this.sourceLayer=data['source-layer'];this.minZoomLevel=data.minzoom;this.maxZoomLevel=data.maxzoom;this.filter=data.filter;this.metadata=data.metadata;}(0,_createClass2.default)(BaseLayer,[{key:"json",get:function get(){var id=this.id,type=this.type,source=this.source,sourceLayer=this.sourceLayer,minZoomLevel=this.minZoomLevel,maxZoomLevel=this.maxZoomLevel,filter=this.filter,metadata=this.metadata;var data={id:id,type:type};if(source)data.source=source;if(sourceLayer)data['source-layer']=sourceLayer;if(minZoomLevel)data.minZoomLevel=minZoomLevel;if(maxZoomLevel)data.maxZoomLevel=maxZoomLevel;if(filter)data.filter=filter;if(this.metadata){data.metadata=metadata;}if(this.paint){data.paint=this.paint.json;}if(this.layout){data.layout=this.layout.json;}return data;}},{key:"style",get:function get(){var base=_objectSpread(_objectSpread({},this.paint),this.layout);var style={};Object.keys(base).forEach(function(key){if(base[key]){style[key]=base[key];}});return style;}},{key:"setFilterLevel",value:function setFilterLevel(level){var _this=this;var newFilter=(0,_lodash.cloneDeep)(this.filter);this.filter.forEach(function(_filter,filterIndex){var filter=(0,_lodash.cloneDeep)(_filter);var changed=false;if(_this.id==='proximiio-levelchangers'){var lvl="__level_"+level;if(filterIndex===3){filter[1]=lvl;changed=true;}if(filterIndex===4){filter[1][1]=lvl;changed=true;}}if(Array.isArray(filter)){if(filter[0]==='=='){var expression=filter[1];if(expression[0]==='to-number'){if(expression[1][0]==='get'&&expression[1][1]==='level'){filter[2]=level;changed=true;}}if(expression[0]==='get'&&expression[1]==='level'){filter[2]=level;changed=true;}}if(filter[0]==='<='){var _expression=filter[1];if(_expression[0]==='to-number'){if(_expression[1][0]==='get'&&_expression[1][1]==='level_min'){filter[2]=level;changed=true;}}if(_expression[0]==='get'&&_expression[1]==='level_min'){filter[2]=level;changed=true;}}if(filter[0]==='>='){var _expression2=filter[1];if(_expression2[0]==='to-number'){if(_expression2[1][0]==='get'&&_expression2[1][1]==='level_max'){filter[2]=level;changed=true;}}if(_expression2[0]==='get'&&_expression2[1]==='level_max'){filter[2]=level;changed=true;}}}if(changed){newFilter[filterIndex]=filter;}});this.filter=newFilter;}}]);return BaseLayer;}();exports.default=BaseLayer;
//# sourceMappingURL=base_layer.js.map