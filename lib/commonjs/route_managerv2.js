"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.ProximiioRouteManager=exports.ProximiioRouteEvents=void 0;var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator"));var _classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));var _createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass"));var _assertThisInitialized2=_interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized"));var _inherits2=_interopRequireDefault(require("@babel/runtime/helpers/inherits"));var _possibleConstructorReturn2=_interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));var _getPrototypeOf2=_interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));var _defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));var _reactNative=require("react-native");var _eventable=require("./eventable");var _helpers=require("./helpers");function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=(0,_getPrototypeOf2.default)(Derived),result;if(hasNativeReflectConstruct){var NewTarget=(0,_getPrototypeOf2.default)(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return(0,_possibleConstructorReturn2.default)(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true;}catch(e){return false;}}var ProximiioMapboxNative=_reactNative.NativeModules.ProximiioMapboxNative;var ProximiioRouteEvents;exports.ProximiioRouteEvents=ProximiioRouteEvents;(function(ProximiioRouteEvents){ProximiioRouteEvents["ROUTE_CALCULATED"]="proximiio:route:calculated";ProximiioRouteEvents["ROUTE_UPDATED"]="proximiio:route:updated";ProximiioRouteEvents["ROUTE_PREVIEWED"]="proximiio:route:previewed";ProximiioRouteEvents["ROUTE_ENDED"]="proximiio:route:ended";})(ProximiioRouteEvents||(exports.ProximiioRouteEvents=ProximiioRouteEvents={}));var ProximiioRouteManager=function(_Eventable){(0,_inherits2.default)(ProximiioRouteManager,_Eventable);var _super=_createSuper(ProximiioRouteManager);function ProximiioRouteManager(){var _this;(0,_classCallCheck2.default)(this,ProximiioRouteManager);_this=_super.call(this);(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"route",void 0);(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"routePreviewed",false);(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"routeStarted",false);return _this;}(0,_createClass2.default)(ProximiioRouteManager,[{key:"calculate",value:function calculate(routeConfiguration){return ProximiioMapboxNative.routeCalculate(this._platformRouteConfiguration(routeConfiguration));}},{key:"find",value:function find(routeConfiguration){this.routeStarted=false;this.routePreviewed=false;ProximiioMapboxNative.routeFind(this._platformRouteConfiguration(routeConfiguration));}},{key:"findAndPreview",value:function findAndPreview(routeConfiguration){this.routeStarted=false;this.routePreviewed=true;ProximiioMapboxNative.routeFindAndPreview(this._platformRouteConfiguration(routeConfiguration));}},{key:"findAndStart",value:function findAndStart(routeConfiguration){this.routeStarted=true;this.routePreviewed=true;ProximiioMapboxNative.routeFindAndStart(this._platformRouteConfiguration(routeConfiguration));}},{key:"preview",value:function preview(){if(this.route!=null&&this.routePreviewed&&!this.routeStarted){return false;}else{this.routePreviewed=true;this.notify(ProximiioRouteEvents.ROUTE_PREVIEWED);return true;}}},{key:"_platformRouteConfiguration",value:function _platformRouteConfiguration(routeConfiguration){if(_helpers.isIOS){return routeConfiguration;}else{return JSON.stringify(routeConfiguration);}}},{key:"start",value:function start(){return _regenerator.default.async(function start$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(this.route!=null&&!this.routeStarted)){_context.next=7;break;}this.routeStarted=true;_context.next=4;return _regenerator.default.awrap(ProximiioMapboxNative.routeStart());case 4:return _context.abrupt("return",true);case 7:return _context.abrupt("return",false);case 8:case"end":return _context.stop();}}},null,this,null,Promise);}},{key:"cancel",value:function cancel(){return _regenerator.default.async(function cancel$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return _regenerator.default.awrap(ProximiioMapboxNative.routeCancel());case 2:this.routeStarted=false;case 3:case"end":return _context2.stop();}}},null,this,null,Promise);}},{key:"onCalculated",value:function onCalculated(route){this.route=route;this.notify(ProximiioRouteEvents.ROUTE_CALCULATED,route);}},{key:"onUpdate",value:function onUpdate(event){if(event.eventType=='FINISHED'||event.eventType=='CANCELED'||event.eventType=='ROUTE_NOT_FOUND'||event.eventType=='ROUTE_OSRM_NETWORK_ERROR'){this.routeStarted=false;this.routePreviewed=false;this.route=undefined;this.notify(ProximiioRouteEvents.ROUTE_ENDED,event);}else{this.route=event.route;this.notify(ProximiioRouteEvents.ROUTE_UPDATED,event);}}}]);return ProximiioRouteManager;}(_eventable.Eventable);exports.ProximiioRouteManager=ProximiioRouteManager;
//# sourceMappingURL=route_managerv2.js.map